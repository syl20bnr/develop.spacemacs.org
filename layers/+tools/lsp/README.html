<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-01-21 Fri 02:43 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LSP layer</title>
<meta name="author" content="root" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<link rel="stylesheet" type="text/css"
                 href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
          <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
          <script src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
          <script>
          // Google Analytics
                     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                         (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
                         Date();a=s.createElement(o),
                         m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                         })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                     ga('create', 'UA-28326243-2', 'auto'); ga('send', 'pageview');

          // Add permalinks to the documentation headings
          $(document).ready(function() {
              [".outline-2 h2", ".outline-3 h3", ".outline-4 h4", ".outline-5 h5"].forEach(function(i) {
                  $(i).each(function() {
                          var page_url = window.location.pathname;
                          var node = $(this).attr("id");
                          var full_url = page_url + "#" + node;
                          $(this).contents().last().after('<span id="permalink"><a href="'
                                                          + full_url + '">Â¶</a></span>');
                  });
              });
          });
          </script>
<link rel="stylesheet" type="text/css" href="../../../css/readtheorg.css" />
</head>
<body>
<div id="content" class="content">
<div class="admonition warning">
<p class="first last">
You are viewing the documentation for the develop branch.
The documentation for the release version is
<a href="https://www.spacemacs.org/doc/DOCUMENTATION.html"
onclick="location='https://www.spacemacs.org'+location.pathname+location.search+location.hash;return false;">here</a>
.
</p>
</div>
<div id="toggle-sidebar"><a href="#table-of-contents"><h2>Table of Contents</h2></a></div>
<h1 class="title">LSP layer</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents<a href="#">Close</a></h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#description">1. Description</a>
<ul>
<li><a href="#features">1.1. Features:</a></li>
</ul>
</li>
<li><a href="#configuration">2. Configuration</a>
<ul>
<li><a href="#variables">2.1. Variables</a></li>
<li><a href="#code-lens">2.2. Code Lens</a></li>
<li><a href="#error-statistics-on-modeline">2.3. Error statistics on modeline</a></li>
<li><a href="#code-actions-on-modeline">2.4. Code actions on modeline</a></li>
<li><a href="#navigation-mode">2.5. Navigation mode</a></li>
<li><a href="#breadcrumb-on-headerline">2.6. Breadcrumb on headerline</a></li>
</ul>
</li>
<li><a href="#key-bindings">3. Key bindings</a>
<ul>
<li><a href="#key-binding-prefixes">3.1. Key binding prefixes</a></li>
<li><a href="#core-key-bindings">3.2. Core key bindings</a></li>
<li><a href="#language-specific-key-binding-extensions">3.3. Language-specific key binding extensions</a>
<ul>
<li><a href="#spacemacslsp-define-extensions-layer-name-kind-request-optional-extra-parameters">3.3.1. <code>spacemacs/lsp-define-extensions layer-name kind request &amp;optional extra-parameters</code></a></li>
<li><a href="#spacemacslsp-bind-extensions-for-mode">3.3.2. <code>spacemacs/lsp-bind-extensions-for-mode</code></a></li>
</ul>
</li>
<li><a href="#bind-to-lsp-upstreams">3.4. Bind to lsp upstreams</a></li>
</ul>
</li>
<li><a href="#dap-integration">4. DAP integration</a></li>
<li><a href="#diagnostics">5. Diagnostics</a></li>
<li><a href="#references">6. References</a></li>
</ul>
</div>
</div>

<div id="outline-container-description" class="outline-2">
<h2 id="description"><span class="section-number-2">1.</span> Description</h2>
<div class="outline-text-2" id="text-description">
<p>
This layer adds support for basic language server protocol packages speaking
<a href="https://microsoft.github.io/language-server-protocol/specification">language server protocol</a>.
</p>

<p>
Different language servers may support the language server protocol to varying degrees
and they may also provide extensions; check the language server's website for
details.
<code>M-x lsp-describe-session</code> in a LSP buffer to list capabilities of the server.
</p>
</div>

<div id="outline-container-features" class="outline-3">
<h3 id="features"><span class="section-number-3">1.1.</span> Features:</h3>
<div class="outline-text-3" id="text-features">
<ul class="org-ul">
<li>Cross references (definitions, references, document symbol, workspace symbol
search and others)</li>
<li>Workspace-wide symbol rename</li>
<li>Symbol highlighting</li>
<li>Flycheck</li>
<li>Completion with <code>LSP</code></li>
<li>Signature help with <code>eldoc</code></li>
<li>Symbol documentation in a child frame (<code>lsp-ui-doc</code>)</li>
<li>Navigation using <code>imenu</code></li>
<li>Consistent core key bindings in LSP modes</li>
<li>Code folding (<code>lsp-origami</code>)</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-configuration" class="outline-2">
<h2 id="configuration"><span class="section-number-2">2.</span> Configuration</h2>
<div class="outline-text-2" id="text-configuration">
<p>
Enabling this layer will set the used backend for all supported languages to
<code>LSP</code> unless you explicitly set a specific backend for the language.
</p>

<p>
The LSP ecosystem is based on two packages: <a href="https://github.com/emacs-lsp/lsp-mode">lsp-mode</a> and <a href="https://github.com/emacs-lsp/lsp-ui">lsp-ui</a>.
Please check out their documentation.
</p>
</div>

<div id="outline-container-variables" class="outline-3">
<h3 id="variables"><span class="section-number-3">2.1.</span> Variables</h3>
<div class="outline-text-3" id="text-variables">
<p>
A number of configuration variables have been exposed via the LSP layer <code>config.el</code>.
Sensible defaults have been provided, however they may all be overridden in your .spacemacs, or dynamically using the bindings added
under the derived mode t prefix by <code>(spacemacs/lsp-bind-keys-for-mode mode)</code>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Variable name</th>
<th scope="col" class="org-left">Default</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>lsp-headerline-breadcrumb-enable</code></td>
<td class="org-left">t</td>
<td class="org-left">When non-nil, shows breadcrumb on headerline.</td>
</tr>

<tr>
<td class="org-left"><code>lsp-headerline-breadcrumb-segments</code></td>
<td class="org-left"><code>'(path-up-to-project file symbols)</code></td>
<td class="org-left">Display the path to the root of project, the name of the current file, and also its symbols. See details below.</td>
</tr>

<tr>
<td class="org-left"><code>lsp-lens-enable</code></td>
<td class="org-left">nil</td>
<td class="org-left">When non-nil, shows code lens when it's supported.</td>
</tr>

<tr>
<td class="org-left"><code>lsp-modeline-diagnostics-enable</code></td>
<td class="org-left">t</td>
<td class="org-left">When non-nil, shows error diagnostics in modeline.</td>
</tr>

<tr>
<td class="org-left"><code>lsp-modeline-diagnostics-scope</code></td>
<td class="org-left"><code>:project</code></td>
<td class="org-left">Displays all error statistcs per projects. See details below.</td>
</tr>

<tr>
<td class="org-left"><code>lsp-modeline-code-actions-enable</code></td>
<td class="org-left">t</td>
<td class="org-left">When non-nil, shows available code actions in modeline.</td>
</tr>

<tr>
<td class="org-left"><code>lsp-modeline-code-actions-segments</code></td>
<td class="org-left"><code>'(count icon)</code></td>
<td class="org-left">Display the number of available code actions and an icon. See details below.</td>
</tr>

<tr>
<td class="org-left"><code>lsp-navigation</code></td>
<td class="org-left"><code>'both</code></td>
<td class="org-left"><code>'simple</code> or <code>'peek</code> to bind only xref OR lsp-ui-peek navigation functions.</td>
</tr>

<tr>
<td class="org-left"><code>lsp-use-lsp-ui</code></td>
<td class="org-left">nil</td>
<td class="org-left">When non-nil, install lsp-ui package</td>
</tr>

<tr>
<td class="org-left"><code>lsp-ui-remap-xref-keybindings</code></td>
<td class="org-left">nil</td>
<td class="org-left">When non-nil, xref key bindings remapped to lsp-ui-peek-find-{definition,references}.</td>
</tr>

<tr>
<td class="org-left"><code>lsp-ui-doc-enable</code></td>
<td class="org-left">t</td>
<td class="org-left">When non-nil, the documentation overlay is displayed.</td>
</tr>

<tr>
<td class="org-left"><code>lsp-ui-doc-include-signature</code></td>
<td class="org-left">nil</td>
<td class="org-left">When nil, signature omitted from lsp-ui-doc overlay (this is usually redundant).</td>
</tr>

<tr>
<td class="org-left"><code>lsp-ui-sideline-enable</code></td>
<td class="org-left">t</td>
<td class="org-left">When non-nil, the symbol information overlay is displayed.</td>
</tr>

<tr>
<td class="org-left"><code>lsp-ui-sideline-show-symbol</code></td>
<td class="org-left">nil</td>
<td class="org-left">When non-nil, the symbol information overlay includes symbol name (redundant for c-modes).</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-code-lens" class="outline-3">
<h3 id="code-lens"><span class="section-number-3">2.2.</span> Code Lens</h3>
<div class="outline-text-3" id="text-code-lens">
<p>
Code lens is a feature that displays <code>"actionable contextual information interspersed"</code> in your source code.
In other words, it displays extra information of the source code, and allows you to perform certain actions.
For example, the LSP server may decorate the entry point of a program, and also provides a quick access for running/debugging the program.
</p>

<p>
To always display code lens,
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> dotspacemacs-configuration-layers
              '((lsp <span class="org-builtin">:variables</span> lsp-lens-enable t)))
</pre>
</div>

<p>
This doesn't have any effect when code lens is not supported by current language server.
</p>
</div>
</div>

<div id="outline-container-error-statistics-on-modeline" class="outline-3">
<h3 id="error-statistics-on-modeline"><span class="section-number-3">2.3.</span> Error statistics on modeline</h3>
<div class="outline-text-3" id="text-error-statistics-on-modeline">
<p>
By default, all error statistics of a project is displayed in the modeline.
To disable this feature, set <code>lsp-modeline-diagnostics-enable</code> to <code>nil</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> dotspacemacs-configuration-layers
              '((lsp <span class="org-builtin">:variables</span> lsp-modeline-diagnostics-enable nil)))
</pre>
</div>

<p>
To only display errors for the current file, you can set <code>lsp-modeline-diagnostics-scope</code> to <code>:file</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> dotspacemacs-configuration-layers
              '((lsp <span class="org-builtin">:variables</span> lsp-modeline-diagnostics-scope <span class="org-builtin">:file</span>)))
</pre>
</div>

<p>
Alternatively, if you want to see all errors across all projects, you can set it to <code>:global</code>.
</p>
</div>
</div>

<div id="outline-container-code-actions-on-modeline" class="outline-3">
<h3 id="code-actions-on-modeline"><span class="section-number-3">2.4.</span> Code actions on modeline</h3>
<div class="outline-text-3" id="text-code-actions-on-modeline">
<p>
By default, available code actions are displayed in modeline. To disable this feature, set <code>lsp-modeline-code-actions-enable</code> to <code>nil</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> dotspacemacs-configuration-layers
              '((lsp <span class="org-builtin">:variables</span> lsp-modeline-code-actions-enable nil)))
</pre>
</div>

<p>
You can also customize its appearance via <code>lsp-modeline-code-actions-segments</code>. Available segments are:
</p>
<ul class="org-ul">
<li><code>icon</code> shows a lightbulb icon.</li>
<li><code>name</code> shows the name of the preferred code action.</li>
<li><code>count</code> shows the how many code actions are available.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> dotspacemacs-configuration-layers
              '((lsp <span class="org-builtin">:variables</span>
                     <span class="org-comment-delimiter">;; </span><span class="org-comment">default segments</span>
                     lsp-modeline-code-actions-segments '(count icon))))
</pre>
</div>
</div>
</div>

<div id="outline-container-navigation-mode" class="outline-3">
<h3 id="navigation-mode"><span class="section-number-3">2.5.</span> Navigation mode</h3>
<div class="outline-text-3" id="text-navigation-mode">
<p>
The <code>lsp-navigation</code> variable defined in <code>config.el</code> allows you to define a preference for lightweight or pretty
(using <code>lsp-ui-peek</code>) source navigation styles. By default, the lightweight functions are bound under <code>SPC m g</code>
and the <code>lsp-ui-peek</code> variants under <code>SPC m G</code>. Setting <code>lsp-navigation</code> to either <code>'simple</code> or <code>'peek</code> eliminates
the bindings under <code>SPC m G</code> and creates bindings under <code>SPC m g</code> according to the specified preference.
</p>
</div>
</div>

<div id="outline-container-breadcrumb-on-headerline" class="outline-3">
<h3 id="breadcrumb-on-headerline"><span class="section-number-3">2.6.</span> Breadcrumb on headerline</h3>
<div class="outline-text-3" id="text-breadcrumb-on-headerline">
<p>
To display breadcrumb in the headerline, set <code>lsp-headerline-breadcrumb-enable</code> to <code>t</code>.
</p>

<p>
You can customize the breadcrumb segments via <code>lsp-headerline-breadcrumb-segments</code>. Available segments are:
</p>
<ul class="org-ul">
<li><code>project</code> shows the name of the current project.</li>
<li><code>file</code> shows the name of the current file.</li>
<li><code>path-up-to-project</code> shows the path up to the current project.</li>
<li><code>symbols</code> shows the document symbols.</li>
</ul>

<p>
For example, to display only the symbols,
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> dotspacemacs-configuration-layers
              '((lsp <span class="org-builtin">:variables</span> lsp-headerline-breadcrumb-segments '(symbols))))
</pre>
</div>

<p>
To display the current project, current file, and document symbols,
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> dotspacemacs-configuration-layers
              '((lsp <span class="org-builtin">:variables</span> lsp-headerline-breadcrumb-segments '(project file symbols))))
</pre>
</div>

<p>
You may need to run <code>all-the-icons-install-fonts</code> if you have <code>all-the-icons</code> package installed,
otherwise separators used by <code>lsp-headerline-breadcrumb-mode</code> will be garbled due to fonts missing.
</p>
</div>
</div>
</div>

<div id="outline-container-key-bindings" class="outline-2">
<h2 id="key-bindings"><span class="section-number-2">3.</span> Key bindings</h2>
<div class="outline-text-2" id="text-key-bindings">
<p>
A number of lsp features useful for all/most modes have been bound to the lsp minor mode, meaning they'll be
available in all language layers based on the lsp layer.
</p>
</div>

<div id="outline-container-key-binding-prefixes" class="outline-3">
<h3 id="key-binding-prefixes"><span class="section-number-3">3.1.</span> Key binding prefixes</h3>
<div class="outline-text-3" id="text-key-binding-prefixes">
<p>
The key bindings are grouped under the following prefixes:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">prefix</th>
<th scope="col" class="org-left">name</th>
<th scope="col" class="org-left">functional area</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>SPC m a</code></td>
<td class="org-left">action</td>
<td class="org-left">Code actions</td>
</tr>

<tr>
<td class="org-left"><code>SPC m =</code></td>
<td class="org-left">format</td>
<td class="org-left">Source formatting</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g</code></td>
<td class="org-left">goto</td>
<td class="org-left">Source navigation</td>
</tr>

<tr>
<td class="org-left"><code>SPC m G</code></td>
<td class="org-left">peek</td>
<td class="org-left">Source navigation (lsp-ui-peek overlay)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m F</code></td>
<td class="org-left">folder</td>
<td class="org-left">Add/remove folders from workspace</td>
</tr>

<tr>
<td class="org-left"><code>SPC m h</code></td>
<td class="org-left">help</td>
<td class="org-left">Help</td>
</tr>

<tr>
<td class="org-left"><code>SPC m b</code></td>
<td class="org-left">lsp/backend</td>
<td class="org-left">Catchall. Restart LSP backend, other implementation-specific functionality</td>
</tr>

<tr>
<td class="org-left"><code>SPC m r</code></td>
<td class="org-left">refactor</td>
<td class="org-left">What it says on the tin</td>
</tr>

<tr>
<td class="org-left"><code>SPC m T</code></td>
<td class="org-left">toggle</td>
<td class="org-left">Toggle mode specific features</td>
</tr>

<tr>
<td class="org-left"><code>SPC m T l</code></td>
<td class="org-left">lsp</td>
<td class="org-left">Toggle LSP backend features (documentation / symbol info overlays etc.)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m x</code></td>
<td class="org-left">text (source)</td>
<td class="org-left">Text (source) document related bindings</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-core-key-bindings" class="outline-3">
<h3 id="core-key-bindings"><span class="section-number-3">3.2.</span> Core key bindings</h3>
<div class="outline-text-3" id="text-core-key-bindings">
<p>
The lsp minor mode bindings are:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">binding</th>
<th scope="col" class="org-left">function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>SPC m = b</code></td>
<td class="org-left">format buffer (<code>lsp-mode</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m = r</code></td>
<td class="org-left">format region (<code>lsp-mode</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m = o</code></td>
<td class="org-left">format (organise) imports</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Note</td>
<td class="org-left"><i>The <code>f</code>, <code>r</code> and <code>s</code> actions are placeholders for imminent <code>lsp-mode</code> features</i></td>
</tr>

<tr>
<td class="org-left"><code>SPC m a a</code></td>
<td class="org-left">Execute code action</td>
</tr>

<tr>
<td class="org-left"><code>SPC m a f</code></td>
<td class="org-left">Execute fix action</td>
</tr>

<tr>
<td class="org-left"><code>SPC m a r</code></td>
<td class="org-left">Execute refactor action</td>
</tr>

<tr>
<td class="org-left"><code>SPC m a s</code></td>
<td class="org-left">Execute source action</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>SPC m g t</code></td>
<td class="org-left">goto type-definition (<code>lsp-mode</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g k</code></td>
<td class="org-left">goto viewport word (<code>avy</code>) (See Note 1)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g K</code></td>
<td class="org-left">goto viewport symbol (<code>avy</code>) (See Note 1)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g e</code></td>
<td class="org-left">browse flycheck errors (<code>lsp-treemacs</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g M</code></td>
<td class="org-left">browse file symbols (<code>lsp-ui-imenu</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g h</code></td>
<td class="org-left">goto call hierachy (<code>lsp-treemacs</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g T</code></td>
<td class="org-left">goto type hierachy (<code>lsp-treemacs</code>)</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Note</td>
<td class="org-left">/Replaced by the lsp-ui-peek equivalents when <code>lsp-navigation</code> is <code>'peek</code> /</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g i</code></td>
<td class="org-left">find implementations (<code>lsp-mode</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g d</code></td>
<td class="org-left">find definitions (<code>xref</code> / <code>lsp-mode</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g r</code></td>
<td class="org-left">find references (<code>xref</code> / <code>lsp</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g s</code></td>
<td class="org-left">find symbol in project (<code>helm-lsp</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g S</code></td>
<td class="org-left">find symbol in all projects (<code>helm-lsp</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g p</code></td>
<td class="org-left">goto previous (<code>xref-pop-marker-stack</code>)</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Note</td>
<td class="org-left">/Omitted when <code>lsp-navigation</code> is <code>'peek</code> or <code>'simple</code> /</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><i>Bound under <code>SPC m g</code> rather than <code>SPC m G</code> when <code>lsp-navigation</code> == <code>'peek</code></i></td>
</tr>

<tr>
<td class="org-left"><code>SPC m G i</code></td>
<td class="org-left">find implementation (<code>lsp-ui-peek</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m G d</code></td>
<td class="org-left">find definitions (<code>lsp-ui-peek</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m G r</code></td>
<td class="org-left">find references (<code>lsp-ui-peek</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m G s</code></td>
<td class="org-left">find workspace symbol (<code>lsp-ui-peek</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m G S</code></td>
<td class="org-left">goto workspace symbol (<code>lsp-treemacs-symbols</code>)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m G p</code></td>
<td class="org-left">goto previous (<code>lsp-ui-peek</code> stack - see Note 2)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m G n</code></td>
<td class="org-left">goto next (<code>lsp-ui-peek stack</code> - see Note 2)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m G E</code></td>
<td class="org-left">browse flycheck errors (<code>lsp-ui</code>)</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>SPC m h h</code></td>
<td class="org-left">describe thing at point</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>SPC m b s</code></td>
<td class="org-left"><code>lsp-workspace-shutdown</code></td>
</tr>

<tr>
<td class="org-left"><code>SPC m b r</code></td>
<td class="org-left"><code>lsp-workspace-restart</code></td>
</tr>

<tr>
<td class="org-left"><code>SPC m b d</code></td>
<td class="org-left"><code>lsp-describe-session</code></td>
</tr>

<tr>
<td class="org-left"><code>SPC m b v</code></td>
<td class="org-left"><code>lsp-version</code></td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>SPC m r r</code></td>
<td class="org-left">rename</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>SPC m T l d</code></td>
<td class="org-left">toggle documentation overlay</td>
</tr>

<tr>
<td class="org-left"><code>SPC m T l F</code></td>
<td class="org-left">toggle documentation overlay function signature</td>
</tr>

<tr>
<td class="org-left"><code>SPC m T l s</code></td>
<td class="org-left">toggle symbol info overlay</td>
</tr>

<tr>
<td class="org-left"><code>SPC m T l S</code></td>
<td class="org-left">toggle symbol info overlay symbol name</td>
</tr>

<tr>
<td class="org-left"><code>SPC m T l I</code></td>
<td class="org-left">toggle symbol info overlay duplicates</td>
</tr>

<tr>
<td class="org-left"><code>SPC m T l l</code></td>
<td class="org-left">toggle lenses</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>SPC m F r</code></td>
<td class="org-left">Remove workspace folder</td>
</tr>

<tr>
<td class="org-left"><code>SPC m F a</code></td>
<td class="org-left">Add workspace folder</td>
</tr>

<tr>
<td class="org-left"><code>SPC m F s</code></td>
<td class="org-left">Switch workspace folder</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>SPC m x h</code></td>
<td class="org-left">Highlight all instances of symbol under point</td>
</tr>

<tr>
<td class="org-left"><code>SPC m x l</code></td>
<td class="org-left">Show code lenses</td>
</tr>

<tr>
<td class="org-left"><code>SPC m x L</code></td>
<td class="org-left">Hide code lenses</td>
</tr>
</tbody>
</table>

<p>
Note 1: Your language server may not distinguish between the word and symbol variants of this binding.
Note 2: There is a window local jump list dedicated to cross references.
</p>
</div>
</div>

<div id="outline-container-language-specific-key-binding-extensions" class="outline-3">
<h3 id="language-specific-key-binding-extensions"><span class="section-number-3">3.3.</span> Language-specific key binding extensions</h3>
<div class="outline-text-3" id="text-language-specific-key-binding-extensions">
<p>
Some LSP server implementations provide extensions to the protocol, which can be leveraged using <code>lsp-find-custom</code>
or <code>lsp-ui-peek-find-custom</code>. A number of additional functions have been provided to facilitate wrapping these extensions
in a manner consistent with the <code>lsp-navigation</code> setting.
</p>
</div>

<div id="outline-container-spacemacslsp-define-extensions-layer-name-kind-request-optional-extra-parameters" class="outline-4">
<h4 id="spacemacslsp-define-extensions-layer-name-kind-request-optional-extra-parameters"><span class="section-number-4">3.3.1.</span> <code>spacemacs/lsp-define-extensions layer-name kind request &amp;optional extra-parameters</code></h4>
<div class="outline-text-4" id="text-spacemacslsp-define-extensions-layer-name-kind-request-optional-extra-parameters">
<p>
Use this to define an extension to the lsp find functions. An example from the c-c++ layer:
</p>

<div class="org-src-container">
<pre class="src src-elisp">(spacemacs/lsp-define-extensions <span class="org-string">"c-c++"</span> 'refs-address
                                 <span class="org-string">"textDocument/references"</span>
                                 '(plist-put (lsp--text-document-position-params) <span class="org-builtin">:context</span> '(<span class="org-builtin">:role</span> 128)))
</pre>
</div>

<p>
This defines the following interactive functions:
</p>
<ul class="org-ul">
<li><code>c-c++/find-refs-address</code></li>
<li><code>c-c++/peek-refs-address</code></li>
</ul>
</div>
</div>

<div id="outline-container-spacemacslsp-bind-extensions-for-mode" class="outline-4">
<h4 id="spacemacslsp-bind-extensions-for-mode"><span class="section-number-4">3.3.2.</span> <code>spacemacs/lsp-bind-extensions-for-mode</code></h4>
<div class="outline-text-4" id="text-spacemacslsp-bind-extensions-for-mode">
<p>
Use this to bind one or more extensions under <code>SPC m g</code> and/or <code>SPC m G</code>, as dictated by the value of <code>lsp-navigation</code>.
Using another example from the c-c++ layer:
</p>

<div class="org-src-container">
<pre class="src src-elisp">(spacemacs/lsp-bind-extensions-for-mode mode <span class="org-string">"c-c++"</span>
                                        <span class="org-string">"&amp;"</span> 'refs-address
                                        <span class="org-string">"R"</span> 'refs-read
                                        <span class="org-string">"W"</span> 'refs-write
                                        <span class="org-string">"c"</span> 'callers
                                        <span class="org-string">"C"</span> 'callees
                                        <span class="org-string">"v"</span> 'vars)
</pre>
</div>

<p>
With <code>lsp-navigation</code> set to <code>'both</code> (the default), this is equivalent to:
</p>

<div class="org-src-container">
<pre class="src src-elisp">(spacemacs/set-leader-keys-for-major-mode mode
  <span class="org-string">"g&amp;"</span> 'c-c++/find-refs-address
  <span class="org-string">"gR"</span> 'c-c++/find-refs-read
  <span class="org-string">"gW"</span> 'c-c++/find-refs-write
  <span class="org-string">"gc"</span> 'c-c++/find-callers
  <span class="org-string">"gC"</span> 'c-c++/find-callees
  <span class="org-string">"gv"</span> 'c-c++/find-vars
  <span class="org-string">"G&amp;"</span> 'c-c++/peek-refs-address
  <span class="org-string">"GR"</span> 'c-c++/peek-refs-read
  <span class="org-string">"GW"</span> 'c-c++/peek-refs-write
  <span class="org-string">"Gc"</span> 'c-c++/peek-callers
  <span class="org-string">"GC"</span> 'c-c++/peek-callees
  <span class="org-string">"Gv"</span> 'c-c++/peek-vars)
</pre>
</div>

<p>
whereas with <code>lsp-navigation</code> set to <code>'peek</code>, this is equivalent to:
</p>

<div class="org-src-container">
<pre class="src src-elisp">(spacemacs/set-leader-keys-for-major-mode mode
  <span class="org-string">"g&amp;"</span> 'c-c++/peek-refs-address
  <span class="org-string">"gR"</span> 'c-c++/peek-refs-read
  <span class="org-string">"gW"</span> 'c-c++/peek-refs-write
  <span class="org-string">"gc"</span> 'c-c++/peek-callers
  <span class="org-string">"gC"</span> 'c-c++/peek-callees
  <span class="org-string">"gv"</span> 'c-c++/peek-vars)
</pre>
</div>

<p>
etc.
</p>
</div>
</div>
</div>

<div id="outline-container-bind-to-lsp-upstreams" class="outline-3">
<h3 id="bind-to-lsp-upstreams"><span class="section-number-3">3.4.</span> Bind to lsp upstreams</h3>
<div class="outline-text-3" id="text-bind-to-lsp-upstreams">
<p>
Alternatively, you can have <code>lsp-mode</code> handle the bindings for you,
by setting <code>lsp-use-upstream-bindings</code> to <code>t</code>.
In this case Spacemacs will bind the <code>lsp-command-map</code> behind <code>SPC m</code>, <code>,</code> and
<code>M-m</code>.
</p>

<p>
The detailed bindings can be found <a href="https://emacs-lsp.github.io/lsp-mode/page/keybindings/">here</a>
where Spacemacs only replaces the prefix <code>s-l</code> with <code>SPC m</code>.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">lsp binding</th>
<th scope="col" class="org-left">Spacemacs binding</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>s-l w s</code></td>
<td class="org-left"><code>SPC m w s</code> or <code>, w s</code> or <code>M-m w s</code></td>
</tr>
</tbody>
</table>

<p>
As <code>lsp-mode</code> and has a deep integration into <code>Spacemacs</code>. <code>Spacemacs</code> hackers
should pay attention to avoid any binding collision with <code>lsp-mode</code>.
</p>

<div class="org-src-container">
<pre class="src src-elisp">(lsp <span class="org-builtin">:variables</span> lsp-use-upstream-bindings t)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-dap-integration" class="outline-2">
<h2 id="dap-integration"><span class="section-number-2">4.</span> DAP integration</h2>
<div class="outline-text-2" id="text-dap-integration">
<p>
<code>lsp-mode</code> integrates with <code>dap-mode</code>, which implements DAP(Debugger Adapter Protocol). See documentation on <code>DAP</code> layer for details.
</p>
</div>
</div>

<div id="outline-container-diagnostics" class="outline-2">
<h2 id="diagnostics"><span class="section-number-2">5.</span> Diagnostics</h2>
<div class="outline-text-2" id="text-diagnostics">
<p>
If some features do not work as expected, here is a common check list.
</p>
<ul class="org-ul">
<li><code>M-x lsp-describe-session</code> If the LSP workspace is initialized correctly</li>
<li><code>M-: xref-backend-functions</code> should be <code>(lsp--xref-backend)</code> for cross
references</li>
<li><code>M-: completion-at-point-functions</code> should be <code>(lsp-completion-at-point)</code> for
completion</li>
</ul>
</div>
</div>

<div id="outline-container-references" class="outline-2">
<h2 id="references"><span class="section-number-2">6.</span> References</h2>
<div class="outline-text-2" id="text-references">
<ul class="org-ul">
<li><a href="https://github.com/emacs-lsp/lsp-mode">lsp-mode repo</a></li>
<li><a href="https://github.com/emacs-lsp/lsp-ui">lsp-ui repo</a></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: root</p>
<p class="date">Created: 2022-01-21 Fri 02:43</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
