<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-06-11 Sun 14:58 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Haskell layer</title>
<meta name="author" content="root" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css"
                 href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
          <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
          <script src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
          <script>

          // Add permalinks to the documentation headings
          $(document).ready(function() {
              [".outline-2 h2", ".outline-3 h3", ".outline-4 h4", ".outline-5 h5"].forEach(function(i) {
                  $(i).each(function() {
                          var page_url = window.location.pathname;
                          var node = $(this).attr("id");
                          var full_url = page_url + "#" + node;
                          $(this).contents().last().after('<span id="permalink"><a href="'
                                                          + full_url + '">Â¶</a></span>');
                  });
              });
          });
          </script>
<link rel="stylesheet" type="text/css" href="../../../css/readtheorg.css" />
</head>
<body>
<div id="content" class="content">
<div id="toggle-sidebar"><a href="#table-of-contents"><h2>Table of Contents</h2></a></div>
<h1 class="title">Haskell layer</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents<a href="#">Close</a></h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#description">1. Description</a>
<ul>
<li><a href="#features">1.1. Features:</a></li>
</ul>
</li>
<li><a href="#quick-start-and-how-to-use-this-readme">2. Quick start (and how to use this README)</a></li>
<li><a href="#install">3. Install</a>
<ul>
<li><a href="#layer">3.1. Layer</a></li>
<li><a href="#dependencies">3.2. Dependencies</a></li>
<li><a href="#setup-path">3.3. Setup PATH</a></li>
</ul>
</li>
<li><a href="#configuration">4. Configuration</a>
<ul>
<li><a href="#choosing-a-backend">4.1. Choosing a backend</a>
<ul>
<li><a href="#dante">4.1.1. <code>dante</code></a></li>
<li><a href="#lsp">4.1.2. <code>lsp</code></a></li>
</ul>
</li>
<li><a href="#optional-extras">4.2. Optional extras</a>
<ul>
<li><a href="#structured-haskell-mode">4.2.1. structured-haskell-mode</a></li>
<li><a href="#hindent">4.2.2. hindent</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#key-bindings">5. Key bindings</a>
<ul>
<li><a href="#documentation">5.1. Documentation</a></li>
<li><a href="#debug">5.2. Debug</a></li>
<li><a href="#debug-buffer">5.3. Debug Buffer</a></li>
<li><a href="#repl">5.4. REPL</a></li>
<li><a href="#cabal-commands">5.5. Cabal commands</a></li>
<li><a href="#cabal-files">5.6. Cabal files</a></li>
<li><a href="#refactor">5.7. Refactor</a></li>
</ul>
</li>
<li><a href="#syntax-checking">6. Syntax checking</a>
<ul>
<li><a href="#flycheck">6.1. Flycheck</a></li>
<li><a href="#hlint">6.2. HLint</a></li>
</ul>
</li>
<li><a href="#faq">7. FAQ</a>
<ul>
<li><a href="#dante-reports-missinghidden-imports-for-test-files">7.1. Dante reports missing/hidden imports for test files</a></li>
<li><a href="#the-repl-doesnt-work">7.2. The REPL doesn't work</a></li>
<li><a href="#the-repl-is-stuck">7.3. The REPL is stuck</a></li>
<li><a href="#indentation-doesnt-reset-when-pressing-return-after-an-empty-line">7.4. Indentation doesn't reset when pressing return after an empty line</a></li>
<li><a href="#flycheck-displays-hlint-warnings-but-not-errors">7.5. Flycheck displays HLint warnings but not errors</a></li>
<li><a href="#hlint-fails-with-parse-error">7.6. HLint fails with parse error</a></li>
<li><a href="#i-can-see-highlighted-errors-but-they-dont-appear-in-the-error-list">7.7. I can see highlighted errors but they don't appear in the error list</a></li>
<li><a href="#flycheck-doesnt-work">7.8. Flycheck doesn't work</a></li>
<li><a href="#flycheck-doesnt-work-with-stack">7.9. Flycheck doesn't work with <code>stack</code></a>
<ul>
<li><a href="#the-stack-build-directory-is-wrong">7.9.1. The <code>stack</code> build directory is wrong</a></li>
<li><a href="#the-project-root-directory-is-not-set-properly">7.9.2. The Project root directory is not set properly</a></li>
</ul>
</li>
<li><a href="#haskell-mode-commands-dont-work">7.10. haskell-mode commands don't work</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="org32a3e62" class="figure">
<p><img src="img/haskell.png" alt="haskell.png" />
</p>
</div>

<div id="outline-container-description" class="outline-2">
<h2 id="description"><span class="section-number-2">1.</span> Description</h2>
<div class="outline-text-2" id="text-description">
<p>
This layer adds support for the <a href="https://www.haskell.org/">Haskell</a> language.
</p>
</div>

<div id="outline-container-features" class="outline-3">
<h3 id="features"><span class="section-number-3">1.1.</span> Features:</h3>
<div class="outline-text-3" id="text-features">
<ul class="org-ul">
<li>syntax highlighting for <a href="https://github.com/haskell/haskell-mode">haskell source</a>, <a href="https://github.com/haskell/haskell-mode">cabal files</a>, <a href="https://github.com/bgamari/cmm-mode">C&#x2013; source</a></li>
<li>auto-completion and syntax-checking with one of the selected backends (<code>dante</code> or <code>lsp</code>).</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-quick-start-and-how-to-use-this-readme" class="outline-2">
<h2 id="quick-start-and-how-to-use-this-readme"><span class="section-number-2">2.</span> Quick start (and how to use this README)</h2>
<div class="outline-text-2" id="text-quick-start-and-how-to-use-this-readme">
<ul class="org-ul">
<li>Follow instructions in <b>Install</b> section to correctly install the layer.</li>
<li>Ensure that you have <code>auto-completion</code> and <code>syntax-checking</code> layers enabled.</li>
<li>Set backend to <code>dante</code> (check <b>Configuration</b> section for details). <code>dante</code> is default already, but if <code>lsp</code> layer is enabled, you will have to set it explicitly.</li>
<li>You are ready to go! Open any Haskell project and enjoy syntax-checking, auto-completion and more.</li>
</ul>

<p>
After that, check the rest of the README to:
</p>
<ul class="org-ul">
<li>Learn about more powerful (but more complicated to set up) backend: <code>lsp</code> with <code>hie</code> / <code>hls</code>: Check <b>Configuration</b> -&gt; <b>lsp</b>.</li>
<li>Learn about all the functionalities and key bindings: Check <b>Key bindings</b> and <b>Configuration</b> -&gt; <b>Optional extras</b>.</li>
<li>Learn about the details of how syntax-checking works and how it can be tweaked: Check <b>Syntax checking</b>.</li>
<li>Find solutions to common problems in FAQ: Check <b>FAQ</b>.</li>
</ul>
</div>
</div>

<div id="outline-container-install" class="outline-2">
<h2 id="install"><span class="section-number-2">3.</span> Install</h2>
<div class="outline-text-2" id="text-install">
</div>

<div id="outline-container-layer" class="outline-3">
<h3 id="layer"><span class="section-number-3">3.1.</span> Layer</h3>
<div class="outline-text-3" id="text-layer">
<p>
To use this configuration layer, add it to your <code>~/.spacemacs</code>. You will need to
add <code>haskell</code> to the existing <code>dotspacemacs-configuration-layers</code> list in this
file.
</p>
</div>
</div>

<div id="outline-container-dependencies" class="outline-3">
<h3 id="dependencies"><span class="section-number-3">3.2.</span> Dependencies</h3>
<div class="outline-text-3" id="text-dependencies">
<p>
This layer requires some <a href="https://www.haskell.org/cabal/">cabal</a> packages:
</p>
<ul class="org-ul">
<li><code>apply-refact</code> (required by <code>hlint-refactor</code>)</li>
<li><code>hlint</code> (required by <code>hlint-refactor</code>)</li>
<li><code>stylish-haskell</code> (optional for <code>haskell-mode</code>)</li>
<li><code>hasktags</code> (optional)</li>
<li><code>hoogle</code> (optional for <code>haskell-mode</code> and <code>helm-hoogle</code>)</li>
</ul>

<p>
To install them, use the following command (or the <code>stack</code> equivalent):
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cabal install apply-refact hlint stylish-haskell hasktags hoogle
</pre>
</div>
</div>
</div>

<div id="outline-container-setup-path" class="outline-3">
<h3 id="setup-path"><span class="section-number-3">3.3.</span> Setup PATH</h3>
<div class="outline-text-3" id="text-setup-path">
<p>
First of all, make sure that your <code>$PATH</code> contains the installation path for
Haskell tools like <code>ghc</code>, <code>ghci</code> etc. It depends on how you have installed
<code>ghc</code>, but you can always check it by running <code>which ghc</code> in your terminal.
<code>Stack</code> users should only add the installation path of <code>stack</code> itself. Usually
it's <code>~/.local/bin</code>.
</p>

<p>
Then make sure that your <code>$PATH</code> contains the installation path for the <code>cabal</code>
packages. If you are using <code>cabal</code> it should be <code>~/.cabal/bin</code> or
<code>~/Library/Haskell/bin</code> (for 'Haskell for Mac' users). If you are using <code>stack</code>
then it should be <code>~/.local/bin</code>.
</p>

<p>
For more information about setting up <code>$PATH</code>, check out the corresponding section in
the FAQ (<code>SPC h SPC $PATH RET</code>).
</p>
</div>
</div>
</div>

<div id="outline-container-configuration" class="outline-2">
<h2 id="configuration"><span class="section-number-2">4.</span> Configuration</h2>
<div class="outline-text-2" id="text-configuration">
</div>

<div id="outline-container-choosing-a-backend" class="outline-3">
<h3 id="choosing-a-backend"><span class="section-number-3">4.1.</span> Choosing a backend</h3>
<div class="outline-text-3" id="text-choosing-a-backend">
<p>
Language backend is the core component of a language layer - it has the responsibility of compiling/parsing the actual code and reporting errors, warnings, suggesting fixes, auto-completions and more.
</p>

<p>
To get the most out of the language backend, you will want to ensure that you have <code>auto-completion</code> and <code>syntax-checking</code> layers enabled.
</p>

<p>
Then, to choose a haskell backend, set the haskell layer variable <code>haskell-completion-backend</code>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>haskell <span class="org-builtin">:variables</span> haskell-completion-backend 'dante<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Supported values for <code>haskell-completion-backend</code> are <code>dante</code> and <code>lsp</code>.
</p>

<p>
If you don't specify any value for <code>haskell-completion-backend</code>,
<code>dante</code> will be used as default backend, unless the layer <code>lsp</code> is enabled,
in which case <code>lsp</code> is used as default backend.
</p>

<p>
Backend can be chosen on a per project basis using directory local variables
(files named <code>.dir-locals.el</code> at the root of a project). An example of <code>.dir-locals.el</code> to use the
<code>lsp</code> backend:
</p>

<div class="org-src-container">
<pre class="src src-elisp"><span class="org-comment-delimiter">;;; </span><span class="org-comment">Directory Local Variables</span>
<span class="org-comment-delimiter">;;; </span><span class="org-comment">For more information see (info "(emacs) Directory Variables")</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">(</span>haskell-mode <span class="org-rainbow-delimiters-depth-3">(</span>haskell-completion-backend . lsp<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
<b>Note:</b> you can easily add a directory local variable with <code>SPC f v d</code>.
</p>

<p>
There are two backends available: <code>dante</code> and <code>lsp</code>.
</p>

<p>
<code>dante</code> is lightweight, requires no setup and works out of the box in most cases, which is why it is also a default backend.
</p>

<p>
<code>lsp</code> (<code>hie</code> or <code>hls</code>) is a more ambitious, heavy-weight, cutting-edge backend that is however still somewhat rough on the edges and requires some additional setup.
</p>
</div>

<div id="outline-container-dante" class="outline-4">
<h4 id="dante"><span class="section-number-4">4.1.1.</span> <code>dante</code></h4>
<div class="outline-text-4" id="text-dante">
<p>
<a href="https://github.com/jyp/dante">Dante</a> is a lightweight backend which delegates most of its work directly to GHCi.
</p>

<p>
It brings features like syntax checking, auto completion, hlint suggestions, automatic error fixing, info at point, definition and use sites.
</p>

<p>
<code>dante</code> works for <code>cabal</code>, <code>nix</code>, <code>sytx</code>, and <code>stack</code> users and requires no additional setup.
</p>
</div>
</div>

<div id="outline-container-lsp" class="outline-4">
<h4 id="lsp"><span class="section-number-4">4.1.2.</span> <code>lsp</code></h4>
<div class="outline-text-4" id="text-lsp">
<p>
<a href="https://microsoft.github.io/language-server-protocol">Language Server Protocol</a> is a standard for implementing language backends.
</p>

<p>
In Haskell layer, you can use a backend that implements Language Server Protocol for Haskell by specifying <code>lsp</code> as backend
and then installing concrete backend implementation, of which there are two available at the moment: <code>hie</code> and <code>hls</code>.
</p>

<p>
Enabling the <code>lsp</code> backend requires the <code>lsp</code> layer to be enabled, and provides access to
all the additional <code>lsp-mode</code> key bindings.
</p>
</div>

<ol class="org-ol">
<li><a id="hie"></a><code>hie</code><br />
<div class="outline-text-5" id="text-hie">
<p>
<a href="https://github.com/haskell/haskell-ide-engine">Haskell Ide Engine</a> (<code>hie</code>) aims to be the universal interface to a growing number of Haskell tools,
providing a fully-featured Language Server Protocol server for editors and IDEs that require Haskell-specific functionality.
</p>

<p>
This is where most of the Haskell community effort is (was - check <code>hls</code>) being focused regarding building Haskell IDE / language backend.
</p>

<p>
<code>hie</code> is best installed by building it locally as it requires that the same GHC version has been used to
compile your code as has been used for <code>hie</code>.
</p>

<p>
To install it please refer to the official installation instructions <a href="https://github.com/haskell/haskell-ide-engine#installation">here</a>.
</p>

<p>
NOTE: <code>hie</code> is being superseded by <code>hls</code>, which is still in early development though.
</p>
</div>
</li>

<li><a id="hls"></a><code>hls</code><br />
<div class="outline-text-5" id="text-hls">
<p>
<a href="https://github.com/haskell/haskell-language-server">Haskell Language Server</a> (<code>hls</code>) is integration point for ghcide and <code>hie</code>. One IDE to rule them all.
</p>

<p>
<code>hls</code> is meant to supersede <code>hie</code> and is therefore the cutting-edge and most ambitious implementation of Haskell language backend.
However, it is still in early stages of development.
</p>

<p>
Check their docs for installation details and how to use it with emacs/spacemacs.
</p>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-optional-extras" class="outline-3">
<h3 id="optional-extras"><span class="section-number-3">4.2.</span> Optional extras</h3>
<div class="outline-text-3" id="text-optional-extras">
<p>
The Haskell layer supports some extra features, which can be enabled through the
layer variables.
</p>
</div>

<div id="outline-container-structured-haskell-mode" class="outline-4">
<h4 id="structured-haskell-mode"><span class="section-number-4">4.2.1.</span> structured-haskell-mode</h4>
<div class="outline-text-4" id="text-structured-haskell-mode">
<p>
Currently there is no support for <a href="https://github.com/chrisdone/structured-haskell-mode">structured-haskell-mode</a>, since it doesn't play
very well with non-emacs editing styles (<a href="https://github.com/chrisdone/structured-haskell-mode/issues/81">structured-haskell-mode/#81</a>). Emacs
editing style users can easily enable it by adding <code>structured-haskell-mode</code> to
the list of <code>dotspacemacs-additional-packages</code> in your <code>.spacemacs</code> file. For
more installation instructions, please refer to the official documentation at
the <a href="https://github.com/chrisdone/structured-haskell-mode#features">structured-haskell-mode</a> page. In case you are a non-emacs editing style user
and still want to use <code>structured-haskell-mode</code> - use it at your own risk.
</p>

<p>
Any contributions that will help to solve issues with <code>structured-haskell-mode</code>
are warmly welcome!
</p>
</div>
</div>

<div id="outline-container-hindent" class="outline-4">
<h4 id="hindent"><span class="section-number-4">4.2.2.</span> hindent</h4>
<div class="outline-text-4" id="text-hindent">
<p>
<a href="https://github.com/commercialhaskell/hindent">hindent</a> is an extensible Haskell pretty printer, which lets you reformat your
code. You need to install the executable with <code>cabal install hindent</code> or
<code>stack install hindent</code>.
</p>

<p>
To enable it you have to toggle the variable <code>haskell-enable-hindent</code>.
</p>

<p>
See examples <a href="https://github.com/commercialhaskell/hindent/blob/master/TESTS.md">here</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq-default</span> dotspacemacs-configuration-layers
  '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>haskell <span class="org-builtin">:variables</span> haskell-enable-hindent t<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-key-bindings" class="outline-2">
<h2 id="key-bindings"><span class="section-number-2">5.</span> Key bindings</h2>
<div class="outline-text-2" id="text-key-bindings">
<p>
All Haskell specific bindings are prefixed with the major-mode leader <code>SPC m</code>.
</p>

<p>
Top-level commands are prefixed by <code>SPC m</code>:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Key binding</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>SPC m g g</code></td>
<td class="org-left">go to definition or tag</td>
</tr>

<tr>
<td class="org-left"><code>SPC m g i</code></td>
<td class="org-left">cycle the Haskell import lines or return to point (with prefix arg)</td>
</tr>

<tr>
<td class="org-left"><code>SPC m F</code></td>
<td class="org-left">format buffer using haskell-stylish</td>
</tr>

<tr>
<td class="org-left"><code>SPC m f</code></td>
<td class="org-left">format declaration using hindent (if enabled)</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-documentation" class="outline-3">
<h3 id="documentation"><span class="section-number-3">5.1.</span> Documentation</h3>
<div class="outline-text-3" id="text-documentation">
<p>
Documentation commands are prefixed by <code>SPC m h</code>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Key binding</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>SPC m h d</code></td>
<td class="org-left">find or generate Haddock documentation for the identifier under the cursor</td>
</tr>

<tr>
<td class="org-left"><code>SPC m h f</code></td>
<td class="org-left">do a helm-hoogle lookup</td>
</tr>

<tr>
<td class="org-left"><code>SPC m h h</code></td>
<td class="org-left">do a Hoogle lookup</td>
</tr>

<tr>
<td class="org-left"><code>SPC m h H</code></td>
<td class="org-left">do a local Hoogle lookup</td>
</tr>

<tr>
<td class="org-left"><code>SPC m h i</code></td>
<td class="org-left">gets information for the identifier under the cursor</td>
</tr>

<tr>
<td class="org-left"><code>SPC m h t</code></td>
<td class="org-left">gets the type of the identifier under the cursor</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-debug" class="outline-3">
<h3 id="debug"><span class="section-number-3">5.2.</span> Debug</h3>
<div class="outline-text-3" id="text-debug">
<p>
Debug commands are prefixed by <code>SPC m d</code>:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Key binding</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>SPC m d a</code></td>
<td class="org-left">abandon current process</td>
</tr>

<tr>
<td class="org-left"><code>SPC m d b</code></td>
<td class="org-left">insert breakpoint at function</td>
</tr>

<tr>
<td class="org-left"><code>SPC m d B</code></td>
<td class="org-left">delete breakpoint</td>
</tr>

<tr>
<td class="org-left"><code>SPC m d c</code></td>
<td class="org-left">continue current process</td>
</tr>

<tr>
<td class="org-left"><code>SPC m d d</code></td>
<td class="org-left">start debug process, needs to be run first</td>
</tr>

<tr>
<td class="org-left"><code>SPC m d n</code></td>
<td class="org-left">next breakpoint</td>
</tr>

<tr>
<td class="org-left"><code>SPC m d N</code></td>
<td class="org-left">previous breakpoint</td>
</tr>

<tr>
<td class="org-left"><code>SPC m d p</code></td>
<td class="org-left">previous breakpoint</td>
</tr>

<tr>
<td class="org-left"><code>SPC m d r</code></td>
<td class="org-left">refresh process buffer</td>
</tr>

<tr>
<td class="org-left"><code>SPC m d s</code></td>
<td class="org-left">step into the next function</td>
</tr>

<tr>
<td class="org-left"><code>SPC m d t</code></td>
<td class="org-left">trace the expression</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-debug-buffer" class="outline-3">
<h3 id="debug-buffer"><span class="section-number-3">5.3.</span> Debug Buffer</h3>
<div class="outline-text-3" id="text-debug-buffer">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Key binding</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>RET</code></td>
<td class="org-left">select object at the point</td>
</tr>

<tr>
<td class="org-left"><code>a</code></td>
<td class="org-left">abandon current computation</td>
</tr>

<tr>
<td class="org-left"><code>b</code></td>
<td class="org-left">break on function</td>
</tr>

<tr>
<td class="org-left"><code>c</code></td>
<td class="org-left">continue the current computation</td>
</tr>

<tr>
<td class="org-left"><code>d</code></td>
<td class="org-left">delete object at the point</td>
</tr>

<tr>
<td class="org-left"><code>i</code></td>
<td class="org-left">step into the next function</td>
</tr>

<tr>
<td class="org-left"><code>r</code></td>
<td class="org-left">refresh the debugger buffer</td>
</tr>

<tr>
<td class="org-left"><code>s</code></td>
<td class="org-left">go to next step to inspect bindings</td>
</tr>

<tr>
<td class="org-left"><code>S</code></td>
<td class="org-left">go to previous step to inspect the bindings</td>
</tr>

<tr>
<td class="org-left"><code>t</code></td>
<td class="org-left">trace the expression</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-repl" class="outline-3">
<h3 id="repl"><span class="section-number-3">5.4.</span> REPL</h3>
<div class="outline-text-3" id="text-repl">
<p>
REPL commands are prefixed by <code>SPC m s</code>:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Key binding</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>SPC m s b</code></td>
<td class="org-left">load or reload the current buffer into the REPL</td>
</tr>

<tr>
<td class="org-left"><code>SPC m s c</code></td>
<td class="org-left">clear the REPL</td>
</tr>

<tr>
<td class="org-left"><code>SPC m s s</code></td>
<td class="org-left">show and switch to the REPL</td>
</tr>

<tr>
<td class="org-left"><code>SPC m s S</code></td>
<td class="org-left">show the REPL without switching to it</td>
</tr>

<tr>
<td class="org-left"><code>SPC m s t</code></td>
<td class="org-left">change the target for the REPL</td>
</tr>

<tr>
<td class="org-left"><code>C-j</code></td>
<td class="org-left">switch to next history item</td>
</tr>

<tr>
<td class="org-left"><code>C-k</code></td>
<td class="org-left">switch to previous history item</td>
</tr>

<tr>
<td class="org-left"><code>C-l</code></td>
<td class="org-left">clear the REPL</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-cabal-commands" class="outline-3">
<h3 id="cabal-commands"><span class="section-number-3">5.5.</span> Cabal commands</h3>
<div class="outline-text-3" id="text-cabal-commands">
<p>
Cabal commands are prefixed by <code>SPC m c</code>:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Key binding</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>SPC m c a</code></td>
<td class="org-left">cabal actions</td>
</tr>

<tr>
<td class="org-left"><code>SPC m c b</code></td>
<td class="org-left">build the current cabal project, i.e. invoke <code>cabal build</code></td>
</tr>

<tr>
<td class="org-left"><code>SPC m c c</code></td>
<td class="org-left">compile the current project, i.e. invoke <code>ghc</code></td>
</tr>

<tr>
<td class="org-left"><code>SPC m c v</code></td>
<td class="org-left">visit the cabal file</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-cabal-files" class="outline-3">
<h3 id="cabal-files"><span class="section-number-3">5.6.</span> Cabal files</h3>
<div class="outline-text-3" id="text-cabal-files">
<p>
These commands are available in a cabal file.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Key binding</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>SPC m d</code></td>
<td class="org-left">add a dependency to the project</td>
</tr>

<tr>
<td class="org-left"><code>SPC m b</code></td>
<td class="org-left">go to benchmark section</td>
</tr>

<tr>
<td class="org-left"><code>SPC m e</code></td>
<td class="org-left">go to executable section</td>
</tr>

<tr>
<td class="org-left"><code>SPC m t</code></td>
<td class="org-left">go to test-suite section</td>
</tr>

<tr>
<td class="org-left"><code>SPC m m</code></td>
<td class="org-left">go to exposed modules</td>
</tr>

<tr>
<td class="org-left"><code>SPC m l</code></td>
<td class="org-left">go to library section</td>
</tr>

<tr>
<td class="org-left"><code>SPC m n</code></td>
<td class="org-left">go to next subsection</td>
</tr>

<tr>
<td class="org-left"><code>SPC m p</code></td>
<td class="org-left">go to previous subsection</td>
</tr>

<tr>
<td class="org-left"><code>SPC m s c</code></td>
<td class="org-left">clear the REPL</td>
</tr>

<tr>
<td class="org-left"><code>SPC m s s</code></td>
<td class="org-left">show the REPL without switching to it</td>
</tr>

<tr>
<td class="org-left"><code>SPC m s S</code></td>
<td class="org-left">show and switch to the REPL</td>
</tr>

<tr>
<td class="org-left"><code>SPC m N</code></td>
<td class="org-left">go to next section</td>
</tr>

<tr>
<td class="org-left"><code>SPC m P</code></td>
<td class="org-left">go to previous section</td>
</tr>

<tr>
<td class="org-left"><code>SPC m f</code></td>
<td class="org-left">find or create source-file under the cursor</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-refactor" class="outline-3">
<h3 id="refactor"><span class="section-number-3">5.7.</span> Refactor</h3>
<div class="outline-text-3" id="text-refactor">
<p>
Refactor commands are prefixed by <code>SPC m r</code>:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Key binding</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>SPC m r b</code></td>
<td class="org-left">apply all HLint suggestions in the current buffer</td>
</tr>

<tr>
<td class="org-left"><code>SPC m r i</code></td>
<td class="org-left">reformat imports from anywhere in the buffer</td>
</tr>

<tr>
<td class="org-left"><code>SPC m r r</code></td>
<td class="org-left">apply the HLint suggestion under the cursor</td>
</tr>
</tbody>
</table>

<p>
Only some of the HLint suggestions can be applied.
</p>
</div>
</div>
</div>

<div id="outline-container-syntax-checking" class="outline-2">
<h2 id="syntax-checking"><span class="section-number-2">6.</span> Syntax checking</h2>
<div class="outline-text-2" id="text-syntax-checking">
<p>
There are multiple components that can indicate
errors and warnings in the code. Those components are:
</p>
<ul class="org-ul">
<li>dante (via flycheck)</li>
<li>hlint (via flycheck)</li>
<li>lsp (via lsp-ui)</li>
</ul>

<p>
Since some of these components can be active at the same time, it can be tricky to
know which component is displaying which message, especially when they disagree,
or if one isn't working. Only flycheck errors (from ghci and hlint) are displayed in
the error list and can be navigated between, using the standard Spacemacs key
bindings (under <code>SPC e</code>) even though errors from other modes might highlight the
actual buffer.
</p>
</div>

<div id="outline-container-flycheck" class="outline-3">
<h3 id="flycheck"><span class="section-number-3">6.1.</span> Flycheck</h3>
<div class="outline-text-3" id="text-flycheck">
<p>
This is the standard Spacemacs way of syntax checking, and it's also the most
elaborate. You need to install the syntax-checking layer first, which will bring flycheck. Please read the
layer's <a href="https://github.com/syl20bnr/spacemacs/tree/develop/layers/+checkers/syntax-checking">documentation</a> on how to interact with flycheck.
</p>

<p>
Flycheck has different Haskell checkers: <code>haskell-dante</code>, <code>haskell-ghc</code>, <code>haskell-stack-ghc</code> and
<code>haskell-hlint</code>. Normally it can detect the best one to use automatically, but
if it doesn't work, then you can change it with <code>SPC e s</code>.
</p>
</div>
</div>

<div id="outline-container-hlint" class="outline-3">
<h3 id="hlint"><span class="section-number-3">6.2.</span> HLint</h3>
<div class="outline-text-3" id="text-hlint">
<p>
<a href="https://github.com/ndmitchell/hlint">HLint</a> is a linter for Haskell. It doesn't detect errors (as long as it can parse
the file) but bad coding style and code smell. The HLint checker is called
<b>after</b> the flycheck GHC checker.
</p>

<p>
HLint can be configured per project via .hlint.yaml (check Hlint docs for more details).
</p>
</div>
</div>
</div>

<div id="outline-container-faq" class="outline-2">
<h2 id="faq"><span class="section-number-2">7.</span> FAQ</h2>
<div class="outline-text-2" id="text-faq">
</div>

<div id="outline-container-dante-reports-missinghidden-imports-for-test-files" class="outline-3">
<h3 id="dante-reports-missinghidden-imports-for-test-files"><span class="section-number-3">7.1.</span> Dante reports missing/hidden imports for test files</h3>
<div class="outline-text-3" id="text-dante-reports-missinghidden-imports-for-test-files">
<p>
The cause might be that Dante is not loading appropriate packages for the test suite target, instead it is loading packages for the library.
</p>

<p>
Solution is to create <code>.dir-local.el</code> in the directory where the test suite (usually <code>test/</code> or <code>tests/</code>) is and to put the line <code>((haskell-mode . ((dante-target . "--test"))))</code> into it.
This tells Dante to use test suite target when working with test files.
</p>
</div>
</div>

<div id="outline-container-the-repl-doesnt-work" class="outline-3">
<h3 id="the-repl-doesnt-work"><span class="section-number-3">7.2.</span> The REPL doesn't work</h3>
<div class="outline-text-3" id="text-the-repl-doesnt-work">
<p>
Usually <code>haskell-mode</code> is great at figuring out which interactive process to
bring up. But if you are experiencing problems with it, then you can help
<code>haskell-mode</code> by setting <code>haskell-process-type</code> as in following code:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq-default</span> dotspacemacs-configuration-layers
  '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>haskell <span class="org-builtin">:variables</span> haskell-process-type 'stack-ghci<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Available options are:
</p>
<ul class="org-ul">
<li>ghci</li>
<li>cabal-repl</li>
<li>cabal-new-repl</li>
<li>cabal-dev</li>
<li>cabal-ghci</li>
<li>stack-ghci</li>
</ul>
</div>
</div>

<div id="outline-container-the-repl-is-stuck" class="outline-3">
<h3 id="the-repl-is-stuck"><span class="section-number-3">7.3.</span> The REPL is stuck</h3>
<div class="outline-text-3" id="text-the-repl-is-stuck">
<p>
Make sure that there's a space between the REPL's <code>Î»&gt;</code> prompt and the cursor.
When there is no space, then the REPL will behave as if it's stuck. Usually,
when you enter normal state, the cursor moves backwards by one character, so there
is no required space when you switch to insert mode. There is a possible
workaround - just add the following snippet to your <code>dotspacemacs/user-config</code>
function:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-2">(</span>configuration-layer/layer-used-p 'haskell<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>add-hook 'haskell-interactive-mode-hook
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-4">()</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">setq-local</span> evil-move-cursor-back nil<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
It makes the cursor stay in the right place in the REPL buffer when you enter
normal state. Which in most cases helps you to avoid the problem with 'stuck'
REPL.
</p>

<p>
Also, some users might want to start the REPL in insert mode. This is done by
placing the following snippet in your <code>dotspacemacs/user-config</code> function:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-2">(</span>configuration-layer/layer-used-p 'haskell<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">defadvice</span> <span class="org-function-name">haskell-interactive-switch</span> <span class="org-rainbow-delimiters-depth-3">(</span>after spacemacs/haskell-interactive-switch-advice activate<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-4">(</span>eq dotspacemacs-editing-style 'vim<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>call-interactively 'evil-insert<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-indentation-doesnt-reset-when-pressing-return-after-an-empty-line" class="outline-3">
<h3 id="indentation-doesnt-reset-when-pressing-return-after-an-empty-line"><span class="section-number-3">7.4.</span> Indentation doesn't reset when pressing return after an empty line</h3>
<div class="outline-text-3" id="text-indentation-doesnt-reset-when-pressing-return-after-an-empty-line">
<p>
This is the intended behavior in <code>haskell-indentation-mode</code>. If you want to
reset the indentation when pressing return after an empty line, add the
following snippet into your <code>dotspacemacs/user-config</code> function.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">haskell-indentation-advice</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">and</span> <span class="org-rainbow-delimiters-depth-4">(</span>&lt; <span class="org-highlight-numbers-number">1</span> <span class="org-rainbow-delimiters-depth-5">(</span>line-number-at-pos<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
             <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">save-excursion</span>
               <span class="org-rainbow-delimiters-depth-5">(</span>forward-line <span class="org-highlight-numbers-number">-1</span><span class="org-rainbow-delimiters-depth-5">)</span>
               <span class="org-rainbow-delimiters-depth-5">(</span>string= <span class="org-string">""</span> <span class="org-rainbow-delimiters-depth-6">(</span>s-trim <span class="org-rainbow-delimiters-depth-7">(</span>buffer-substring <span class="org-rainbow-delimiters-depth-8">(</span>line-beginning-position<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>line-end-position<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>delete-region <span class="org-rainbow-delimiters-depth-4">(</span>line-beginning-position<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>point<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>advice-add 'haskell-indentation-newline-and-indent
            <span class="org-builtin">:after</span> 'haskell-indentation-advice<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-flycheck-displays-hlint-warnings-but-not-errors" class="outline-3">
<h3 id="flycheck-displays-hlint-warnings-but-not-errors"><span class="section-number-3">7.5.</span> Flycheck displays HLint warnings but not errors</h3>
<div class="outline-text-3" id="text-flycheck-displays-hlint-warnings-but-not-errors">
<p>
The HLint checker is called <b>after</b> the normal flycheck checker, even if the
checker fails. Check the <a href="#flycheck-doesnt-work">Flycheck doesn't work</a> section.
</p>
</div>
</div>

<div id="outline-container-hlint-fails-with-parse-error" class="outline-3">
<h3 id="hlint-fails-with-parse-error"><span class="section-number-3">7.6.</span> HLint fails with parse error</h3>
<div class="outline-text-3" id="text-hlint-fails-with-parse-error">
<p>
If HLint is not correctly configured (e.g. does not load some extensions that you are using in your project) it might fail while parsing the file.
</p>

<p>
Check <a href="https://github.com/ndmitchell/hlint">HLint</a> docs for more details.
</p>
</div>
</div>

<div id="outline-container-i-can-see-highlighted-errors-but-they-dont-appear-in-the-error-list" class="outline-3">
<h3 id="i-can-see-highlighted-errors-but-they-dont-appear-in-the-error-list"><span class="section-number-3">7.7.</span> I can see highlighted errors but they don't appear in the error list</h3>
<div class="outline-text-3" id="text-i-can-see-highlighted-errors-but-they-dont-appear-in-the-error-list">
<p>
The error list is only set by flycheck. You are probably seeing errors
highlighted by haskell-mode. Check the <a href="#flycheck-doesnt-work">Flycheck doesn't work</a> section.
</p>
</div>
</div>

<div id="outline-container-flycheck-doesnt-work" class="outline-3">
<h3 id="flycheck-doesnt-work"><span class="section-number-3">7.8.</span> Flycheck doesn't work</h3>
<div class="outline-text-3" id="text-flycheck-doesnt-work">
<p>
You can use the <code>flycheck-compile</code> command to check what's wrong with flycheck.
This will show you the exact command line that's used, and its output.
</p>

<p>
If you are using <code>stack</code>, check the <a href="#flycheck-doesnt-work-with-stack">Flycheck doesn't work with <code>stack</code></a> section.
</p>
</div>
</div>

<div id="outline-container-flycheck-doesnt-work-with-stack" class="outline-3">
<h3 id="flycheck-doesnt-work-with-stack"><span class="section-number-3">7.9.</span> Flycheck doesn't work with <code>stack</code></h3>
<div class="outline-text-3" id="text-flycheck-doesnt-work-with-stack">
<p>
First check that flycheck uses the correct checker, and all the paths are
properly configured using <code>flycheck-verify-setup</code> (<code>SPC e v</code>). You can force the
checker with <code>flycheck-select-checker</code> (<code>SPC e s</code>) to ensure that it uses
<code>haskell-stack-ghc</code>. If it still doesn't work, then it could be one of the
following problems:
</p>
<ul class="org-ul">
<li>The <code>stack</code> build directory is wrong</li>
<li>The project root is not set properly</li>
</ul>
</div>

<div id="outline-container-the-stack-build-directory-is-wrong" class="outline-4">
<h4 id="the-stack-build-directory-is-wrong"><span class="section-number-4">7.9.1.</span> The <code>stack</code> build directory is wrong</h4>
<div class="outline-text-4" id="text-the-stack-build-directory-is-wrong">
<p>
The path to the build directory, which contains some generated files, is
normally under <code>.stack-work/install/&lt;os&gt;/Cabal-&lt;version&gt;/build</code>.
</p>

<p>
However the version of the cabal library that's used by <code>stack</code> to generate the
directory name is not the version of the cabal library that's installed by
<code>stack</code> but rather the version of cabal that's associated to the GHC version.
This error can happen after upgrading cabal or cabal-install. To check if this
is the problem, compare the path name of the build path that's used by flycheck
using <code>flycheck-compile</code> and compare it to the actual path in the <code>.stack-work</code>
directory. If they are different, then you'll need to reinstall ghc using the
command <code>stack setup --upgrade-cabal</code>.
</p>
</div>
</div>

<div id="outline-container-the-project-root-directory-is-not-set-properly" class="outline-4">
<h4 id="the-project-root-directory-is-not-set-properly"><span class="section-number-4">7.9.2.</span> The Project root directory is not set properly</h4>
<div class="outline-text-4" id="text-the-project-root-directory-is-not-set-properly">
<p>
Flycheck launches the GHC command, not from the project root directory, but from
the directory of the file that's being checked. This is normally not a problem,
as all the paths are set properly, however it could be a problem if some
template Haskell functions use relative paths (e.g. in Yesod scaffolded
projects).
</p>

<p>
Until it's fixed in flycheck, the workaround is to wrap the <code>stack</code> command in
order to run all subcommands from the project's root directory. You can do so
with the following script:
</p>

<div class="org-src-container">
<pre class="src src-bash"><span class="org-comment-delimiter">#</span><span class="org-comment">!/bin/</span><span class="org-keyword">bash</span>
<span class="org-builtin">cd</span> <span class="org-sh-quoted-exec">`stack path --project-root`</span>
stack $<span class="org-variable-name">*</span>
</pre>
</div>

<p>
Make sure you set <code>flycheck-haskell-stack-ghc-executable</code> to this script.
</p>
</div>
</div>
</div>

<div id="outline-container-haskell-mode-commands-dont-work" class="outline-3">
<h3 id="haskell-mode-commands-dont-work"><span class="section-number-3">7.10.</span> haskell-mode commands don't work</h3>
<div class="outline-text-3" id="text-haskell-mode-commands-dont-work">
<p>
Some (most) of the haskell-mode commands only work when haskell-mode is in
interactive mode, i.e. has an interactive session associated with it. Load it
using <code>SPC m s b</code>.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: root</p>
<p class="date">Created: 2023-06-11 Sun 14:58</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>