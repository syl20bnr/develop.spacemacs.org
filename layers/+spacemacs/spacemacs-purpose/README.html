<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-02-01 Thu 15:44 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Spacemacs-purpose layer</title>
<meta name="author" content="root" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css"
                 href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
          <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
          <script src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
          <script>

          // Add permalinks to the documentation headings
          $(document).ready(function() {
              [".outline-2 h2", ".outline-3 h3", ".outline-4 h4", ".outline-5 h5"].forEach(function(i) {
                  $(i).each(function() {
                          var page_url = window.location.pathname;
                          var node = $(this).attr("id");
                          var full_url = page_url + "#" + node;
                          $(this).contents().last().after('<span id="permalink"><a href="'
                                                          + full_url + '">Â¶</a></span>');
                  });
              });
          });
          </script>
<link rel="stylesheet" type="text/css" href="../../../css/readtheorg.css" />
</head>
<body>
<div id="content" class="content">
<div id="toggle-sidebar"><a href="#table-of-contents"><h2>Table of Contents</h2></a></div>
<h1 class="title">Spacemacs-purpose layer</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents<a href="#">Close</a></h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#description">1. Description</a>
<ul>
<li><a href="#features">1.1. Features:</a></li>
</ul>
</li>
<li><a href="#purposes">2. Purposes</a>
<ul>
<li><a href="#switch-to-buffer-and-display-buffer">2.1. switch-to-buffer and display-buffer</a></li>
<li><a href="#misc">2.2. misc</a></li>
</ul>
</li>
<li><a href="#install">3. Install</a></li>
<li><a href="#usage">4. Usage</a>
<ul>
<li><a href="#allocate-purposes-in-layers">4.1. Allocate purposes in layers</a></li>
<li><a href="#overwrite-purposes-in-dotfile">4.2. Overwrite purposes in dotfile</a></li>
</ul>
</li>
<li><a href="#key-bindings">5. Key bindings</a></li>
<li><a href="#caveats">6. Caveats</a>
<ul>
<li><a href="#popwin-and-guide-key">6.1. Popwin and guide-key</a></li>
<li><a href="#packages-that-do-display-management">6.2. Packages that do display management</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-description" class="outline-2">
<h2 id="description"><span class="section-number-2">1.</span> Description</h2>
<div class="outline-text-2" id="text-description">
<p>
This layer enables <a href="https://github.com/bmag/emacs-purpose">window-purpose</a>, which provides an alternative, purpose-based
window manager for Emacs. With this layer, your window layout should be robust
and shouldn't change too much when opening all sorts of buffers.
</p>

<p>
Regular <a href="https://github.com/m2ym/popwin-el">popwin</a> is not triggered when window-purpose is enabled. However,
the window-purpose layer provides a <code>purpose-popwin</code> extension, which
brings popwin's behavior to window-purpose and solves that problem.
</p>
</div>

<div id="outline-container-features" class="outline-3">
<h3 id="features"><span class="section-number-3">1.1.</span> Features:</h3>
<div class="outline-text-3" id="text-features">
<ul class="org-ul">
<li>Window layout is more robust and less likely to change unintentionally</li>
<li>Dedicate window to a purpose</li>
<li>User-defined purposes</li>
<li>Extensible window display behavior</li>
<li>Empty <code>purpose-mode-map</code>, to avoid conflicts with other key maps</li>
<li>Replicate popwin behavior for purpose-mode - almost no regression in popup behavior from using window-purpose.</li>
<li>Reuses popwin's settings: <code>popwin:special-display-config</code>, <code>popwin:popup-window-height</code> and <code>popwin:popup-window-width</code>.</li>
<li>Difference from popwin: when several windows are open, popup window is sometimes bigger than with regular popwin in the same situation.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-purposes" class="outline-2">
<h2 id="purposes"><span class="section-number-2">2.</span> Purposes</h2>
<div class="outline-text-2" id="text-purposes">
<p>
window-purpose contains a configuration which assigns a purpose for each
buffer. Later, when Emacs needs to display a buffer in a window, its purpose
helps make a better decision of which window to use.
</p>

<p>
For example, consider the following case: Emacs frame shows three windows - one
for code, one for a terminal and one general-purpose window. The general window
is selected and you want to open a code file. How do you ensure that the code
file will be displayed in the code window? With window-purpose you don't
need to worry about it - you open the file and window-purpose places it in
the correct window.
</p>

<p>
Additionally, you can dedicate a window to a purpose - so that window is
reserved only for buffers that share that purpose.
</p>
</div>

<div id="outline-container-switch-to-buffer-and-display-buffer" class="outline-3">
<h3 id="switch-to-buffer-and-display-buffer"><span class="section-number-3">2.1.</span> switch-to-buffer and display-buffer</h3>
<div class="outline-text-3" id="text-switch-to-buffer-and-display-buffer">
<p>
In regular Emacs, <code>switch-to-buffer</code> follows different rules than the other
switching and popping commands, because it doesn't use <code>display-buffer</code> (which
the other commands do). With window-purpose, this behavior is fixed. The
result is a better control over how buffers are displayed, since
<code>switch-to-buffer</code> doesn't ignore the user's customizations anymore.
</p>
</div>
</div>

<div id="outline-container-misc" class="outline-3">
<h3 id="misc"><span class="section-number-3">2.2.</span> misc</h3>
<div class="outline-text-3" id="text-misc">
<ul class="org-ul">
<li>specialized helm source similar to <code>helm-source-buffers-list</code></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-install" class="outline-2">
<h2 id="install"><span class="section-number-2">3.</span> Install</h2>
<div class="outline-text-2" id="text-install">
<p>
To use this configuration layer, add it to your <code>~/.spacemacs</code>. You will need to
add <code>spacemacs-purpose</code> to the existing <code>dotspacemacs-configuration-layers</code> list in
this file.
</p>
</div>
</div>

<div id="outline-container-usage" class="outline-2">
<h2 id="usage"><span class="section-number-2">4.</span> Usage</h2>
<div class="outline-text-2" id="text-usage">
<p>
With window-purpose layer installed, <code>purpose-mode</code> and <code>pupo-mode</code> are enabled.
You can toggle <code>purpose-mode</code> (<code>SPC : purpose-mode</code>) at any time to return to
purpose-less behavior. You can toggle <code>pupo-mode</code> (<code>SPC : pupo-mode</code>) to turn
off only the purpose-popwin integration.
</p>

<p>
If you change <code>popwin:special-display-config</code> in your <code>dotspacemacs/config</code>, you
should call <code>pupo/update-purpose-config</code> to update purpose-popwin with those
changes.
</p>

<p>
See <a href="https://github.com/bmag/emacs-purpose/wiki">window-purpose wiki</a> to learn more about window-purpose.
</p>
</div>

<div id="outline-container-allocate-purposes-in-layers" class="outline-3">
<h3 id="allocate-purposes-in-layers"><span class="section-number-3">4.1.</span> Allocate purposes in layers</h3>
<div class="outline-text-3" id="text-allocate-purposes-in-layers">
<p>
Layers may assign purposes to buffers that have been created by their packages.
This can either be done by a simple mode mapping or according to the buffer's
name. This follows the same idea as the autocomplete and syntax-checking layers.
</p>

<p>
This means the configuration is not centralised in this layer but
spread among the individual language layers. To ensure
that users can still overwrite these configs it is important
to declare them uniformly in Spacemacs.
</p>

<p>
To do so copy and adjust the following code:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">This will only be called if `window-purpose` is listed</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">among the layer packages.</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">This code also takes care that the right loading</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">order is followed so there is no need for any</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">`with-eval-after-load` constructs.</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">shell/post-init-window-purpose</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>purpose-set-extension-configuration
   <span class="org-builtin">:shell-layer</span>
   <span class="org-rainbow-delimiters-depth-3">(</span>purpose-conf <span class="org-builtin">:mode-purposes</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>vterm-mode . terminal<span class="org-rainbow-delimiters-depth-5">)</span>
                                  <span class="org-rainbow-delimiters-depth-5">(</span>eshell-mode . terminal<span class="org-rainbow-delimiters-depth-5">)</span>
                                  <span class="org-rainbow-delimiters-depth-5">(</span>shell-mode . terminal<span class="org-rainbow-delimiters-depth-5">)</span>
                                  <span class="org-rainbow-delimiters-depth-5">(</span>term-mode . terminal<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
   <span class="org-comment-delimiter">;; </span><span class="org-comment">This can also be a static name allocation</span>
   <span class="org-comment-delimiter">;;            </span><span class="org-comment">:name-purposes '(("*Anaconda Help*" . Help))</span>
   <span class="org-comment-delimiter">;; </span><span class="org-comment">or a dynamic one following a regexp</span>
   <span class="org-comment-delimiter">;;            </span><span class="org-comment">:regexp-purposes '(("^\\*Anaconda" . general))</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-overwrite-purposes-in-dotfile" class="outline-3">
<h3 id="overwrite-purposes-in-dotfile"><span class="section-number-3">4.2.</span> Overwrite purposes in dotfile</h3>
<div class="outline-text-3" id="text-overwrite-purposes-in-dotfile">
<p>
With layers defining all kinds of purposes there will surely
come the point where one wishes to change one or two of
these allocations to match ones own personal needs.
</p>

<p>
This can easily be achieved by adding below code in
`dotspacemacs/user-config`:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">This will add user allocations with a higher</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">priority than the ones from the layers.</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">With this allocations can be completely</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">customised.</span>
<span class="org-rainbow-delimiters-depth-1">(</span>purpose-add-user-purposes <span class="org-builtin">:names</span> '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"*Anaconda Help*"</span> . general<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
                           <span class="org-builtin">:regexps</span> '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"\\.hy$"</span> . python<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-key-bindings" class="outline-2">
<h2 id="key-bindings"><span class="section-number-2">5.</span> Key bindings</h2>
<div class="outline-text-2" id="text-key-bindings">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Key binding</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>SPC r b</code></td>
<td class="org-left">Open a buffer. Only buffers with the same purpose as the current buffer are listed.</td>
</tr>

<tr>
<td class="org-left"><code>SPC r B</code></td>
<td class="org-left">Open any buffer and ignore window-purpose when displaying the buffer.</td>
</tr>

<tr>
<td class="org-left"><code>SPC r d b</code></td>
<td class="org-left">Toggle dedication of selected window to its current buffer purpose.</td>
</tr>

<tr>
<td class="org-left"><code>SPC r d w</code></td>
<td class="org-left">Toggle dedication of selected window to its current purpose.</td>
</tr>

<tr>
<td class="org-left"><code>SPC r D</code></td>
<td class="org-left">Delete all non-dedicated windows.</td>
</tr>

<tr>
<td class="org-left"><code>SPC r p</code></td>
<td class="org-left">Choose a purpose and open a buffer with that purpose.</td>
</tr>

<tr>
<td class="org-left"><code>SPC r P</code></td>
<td class="org-left">Change the purpose of the selected window. Changes the window's buffer accordingly.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-caveats" class="outline-2">
<h2 id="caveats"><span class="section-number-2">6.</span> Caveats</h2>
<div class="outline-text-2" id="text-caveats">
</div>

<div id="outline-container-popwin-and-guide-key" class="outline-3">
<h3 id="popwin-and-guide-key"><span class="section-number-3">6.1.</span> Popwin and guide-key</h3>
<div class="outline-text-3" id="text-popwin-and-guide-key">
<p>
If a buffer is displayed in two different windows, and only one of those windows
is purpose-dedicated, then invoking guide-key will cause both windows to become
purpose-dedicated.
</p>
</div>
</div>

<div id="outline-container-packages-that-do-display-management" class="outline-3">
<h3 id="packages-that-do-display-management"><span class="section-number-3">6.2.</span> Packages that do display management</h3>
<div class="outline-text-3" id="text-packages-that-do-display-management">
<p>
Some packages that manage how windows are displayed, such as <code>gdb</code> with
<code>gdb-many-windows</code>, might not play nicely with <code>window-purpose</code>. However, it is
usually possible to find a solution. After all, even <code>helm</code> and <code>popwin</code> work
with <code>window-purpose</code>.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: root</p>
<p class="date">Created: 2024-02-01 Thu 15:44</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
